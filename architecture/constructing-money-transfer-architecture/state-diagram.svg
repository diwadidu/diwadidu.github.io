<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2814.7221px" preserveAspectRatio="none" style="width:2003px;height:2814px;" version="1.1" viewBox="0 0 2003 2814" width="2003.7005px" zoomAndPan="magnify"><defs><filter height="300%" id="fsyf6i463mf1q" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="6.815307820299501"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="13.630615640599002" dy="13.630615640599002" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="405.5108" cy="61.3378" fill="#000000" filter="url(#fsyf6i463mf1q)" rx="34.0765" ry="34.0765" style="stroke: none; stroke-width: 3.4076539101497505;"/><rect fill="#F8F8F8" filter="url(#fsyf6i463mf1q)" height="316.9784" rx="42.5957" ry="42.5957" style="stroke: #383838; stroke-width: 5.1114808652246255;" width="770.1298" x="20.4459" y="303.2812"/><line style="stroke: #383838; stroke-width: 5.1114808652246255;" x1="20.4459" x2="790.5757" y1="393.5441" y2="393.5441"/><text fill="#000000" font-family="sans-serif" font-size="47.7072" lengthAdjust="spacingAndGlyphs" textLength="74.9684" x="368.0266" y="366.4426">Init</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="609.97" x="37.4842" y="450.1165">Transfer Service initialized with</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="701.9767" x="37.4842" y="498.2762">amount and two account references</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="71.5607" x="37.4842" y="546.4359">---</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="500.9251" x="37.4842" y="594.5957">Generate a transaction ID</text><rect fill="#F8F8F8" filter="url(#fsyf6i463mf1q)" height="220.6589" rx="42.5957" ry="42.5957" style="stroke: #383838; stroke-width: 5.1114808652246255;" width="589.5241" x="110.7488" y="828.0599"/><line style="stroke: #383838; stroke-width: 5.1114808652246255;" x1="110.7488" x2="700.2729" y1="918.3228" y2="918.3228"/><text fill="#000000" font-family="sans-serif" font-size="47.7072" lengthAdjust="spacingAndGlyphs" textLength="313.5042" x="248.7587" y="891.2213">DebitAccount</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="521.371" x="127.787" y="974.8952">Debit the amount from the</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="306.6889" x="127.787" y="1023.0549">source account.</text><rect fill="#F8F8F8" filter="url(#fsyf6i463mf1q)" height="220.6589" rx="42.5957" ry="42.5957" style="stroke: #383838; stroke-width: 5.1114808652246255;" width="572.4859" x="282.8353" y="2279.7205"/><line style="stroke: #383838; stroke-width: 5.1114808652246255;" x1="282.8353" x2="855.3211" y1="2369.9834" y2="2369.9834"/><text fill="#000000" font-family="sans-serif" font-size="47.7072" lengthAdjust="spacingAndGlyphs" textLength="252.1664" x="442.995" y="2342.8819">ActivityLog</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="504.3328" x="299.8735" y="2426.5557">Event Log for transactions</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="258.9817" x="299.8735" y="2474.7155">in the system</text><rect fill="#F8F8F8" filter="url(#fsyf6i463mf1q)" height="220.6589" rx="42.5957" ry="42.5957" style="stroke: #383838; stroke-width: 5.1114808652246255;" width="480.4792" x="488.9983" y="1311.9468"/><line style="stroke: #383838; stroke-width: 5.1114808652246255;" x1="488.9983" x2="969.4775" y1="1402.2097" y2="1402.2097"/><text fill="#000000" font-family="sans-serif" font-size="47.7072" lengthAdjust="spacingAndGlyphs" textLength="333.9501" x="562.2629" y="1375.1082">CreditAccount</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="412.3261" x="506.0366" y="1458.782">Credit target account</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="357.8037" x="506.0366" y="1506.9418">with same amount</text><rect fill="#F8F8F8" filter="url(#fsyf6i463mf1q)" height="220.6589" rx="42.5957" ry="42.5957" style="stroke: #383838; stroke-width: 5.1114808652246255;" width="569.0782" x="904.7321" y="1795.8336"/><line style="stroke: #383838; stroke-width: 5.1114808652246255;" x1="904.7321" x2="1473.8103" y1="1886.0965" y2="1886.0965"/><text fill="#000000" font-family="sans-serif" font-size="47.7072" lengthAdjust="spacingAndGlyphs" textLength="340.7654" x="1018.8885" y="1858.995">Compensation</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="412.3261" x="921.7704" y="1942.6689">Roll back the original</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="500.9251" x="921.7704" y="1990.8286">charge on source account</text><rect fill="#F8F8F8" filter="url(#fsyf6i463mf1q)" height="220.6589" rx="42.5957" ry="42.5957" style="stroke: #383838; stroke-width: 5.1114808652246255;" width="644.0466" x="976.2928" y="2279.7205"/><line style="stroke: #383838; stroke-width: 5.1114808652246255;" x1="976.2928" x2="1620.3394" y1="2369.9834" y2="2369.9834"/><text fill="#000000" font-family="sans-serif" font-size="47.7072" lengthAdjust="spacingAndGlyphs" textLength="327.1348" x="1134.7488" y="2342.8819">MonitoredLog</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="575.8935" x="993.3311" y="2426.5557">Error log for transactions that</text><text fill="#000000" font-family="sans-serif" font-size="40.8918" lengthAdjust="spacingAndGlyphs" textLength="487.2945" x="993.3311" y="2474.7155">need human intervention</text><ellipse cx="930.2895" cy="2743.1614" fill="none" filter="url(#fsyf6i463mf1q)" rx="34.0765" ry="34.0765" style="stroke: #000000; stroke-width: 3.4076539101497505;"/><ellipse cx="931.9933" cy="2744.8652" fill="#000000" rx="20.4459" ry="20.4459" style="stroke: none; stroke-width: 3.4076539101497505;"/><!--MD5=[6c6fd5bc6631f4eb2dc5d7a81c52ede6]
link *start to Init--><path d="M405.5108,95.6188 C405.5108,136.8855 405.5108,213.2169 405.5108,285.2547 " fill="none" id="*start-&gt;Init" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="405.5108,302.4634,419.1414,271.7945,405.5108,285.4251,391.8802,271.7945,405.5108,302.4634" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><!--MD5=[5819a9ecaac6aaf645c02fbcd4d0b5a9]
link Init to DebitAccount--><path d="M405.5108,620.4315 C405.5108,682.0079 405.5108,751.8988 405.5108,810.1356 " fill="none" id="Init-&gt;DebitAccount" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="405.5108,827.8214,419.1414,797.1525,405.5108,810.7831,391.8802,797.1525,405.5108,827.8214" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><!--MD5=[c5c49cd547d1dbee45943c4d167bc4f5]
link DebitAccount to DebitAccount--><path d="M700.4433,900.0296 C769.0393,903.3009 819.5408,916.2159 819.5408,938.8087 C819.5408,959.459 777.354,972.0333 717.7201,976.5314 " fill="none" id="DebitAccount-&gt;DebitAccount" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="700.4433,977.5878,731.9089,989.2619,717.4478,976.5158,730.1939,962.0547,700.4433,977.5878" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="337.3577" x="839.9867" y="930.5225">On failure, retry</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="112.4526" x="872.3594" y="982.6955">up to</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="27.2612" x="998.4426" y="982.6955">n</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="119.2679" x="1039.3344" y="982.6955">times</text><!--MD5=[336584abdb455af15d6ea99fd1b95581]
link DebitAccount to ActivityLog--><path d="M405.9197,1050.3752 C407.3169,1169.132 412.292,1365.3106 429.3644,1533.4443 C455.8078,1793.6186 510.9436,2094.8552 543.4867,2260.8761 " fill="none" id="DebitAccount-&gt;ActivityLog" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="546.9285,2278.4937,554.3348,2245.7596,543.6151,2261.7807,527.594,2251.061,546.9285,2278.4937" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="136.3062" x="449.8103" y="1681.9101">failure</text><!--MD5=[1a6d3df6ffaed67efcc6963bbc59e266]
link DebitAccount to CreditAccount--><path d="M478.9798,1050.4775 C528.6294,1123.6739 594.3289,1220.4853 645.9549,1296.5442 " fill="none" id="DebitAccount-&gt;CreditAccount" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="656.0756,1311.4697,650.1954,1278.4273,646.5348,1297.3532,627.609,1293.6926,656.0756,1311.4697" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="385.0649" x="589.5241" y="1198.0233">successful charge</text><!--MD5=[3d0c8cd83b0281ad6a6882f93aa304ca]
link CreditAccount to CreditAccount--><path d="M969.4775,1378.1915 C1036.9491,1380.1339 1088.7454,1394.9913 1088.7454,1422.6955 C1088.7454,1448.0485 1045.4682,1462.5991 986.5158,1466.4157 " fill="none" id="CreditAccount-&gt;CreditAccount" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="969.4775,1467.1995,1000.7369,1479.4153,986.498,1466.4214,999.492,1452.1825,969.4775,1467.1995" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="337.3577" x="1109.1913" y="1414.4093">On failure, retry</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="112.4526" x="1134.7488" y="1466.5824">up to</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="27.2612" x="1260.8319" y="1466.5824">n</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="119.2679" x="1301.7238" y="1466.5824">times</text><!--MD5=[5222a9efd3eb8774545b59e6abaf0ef4]
link CreditAccount to Compensation--><path d="M833.6144,1534.3643 C904.8003,1608.1741 999.1241,1705.9738 1072.7295,1782.3052 " fill="none" id="CreditAccount-&gt;Compensation" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="1085.3037,1795.3565,1073.8273,1763.8182,1073.4768,1783.0916,1054.2034,1782.7412,1085.3037,1795.3565" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="119.2679" x="988.2196" y="1681.9101">failed</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="27.2612" x="1121.1181" y="1681.9101">n</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="119.2679" x="1162.01" y="1681.9101">times</text><!--MD5=[e3daafe4737a8c6b6a25783ca3ffbd5b]
link Compensation to Compensation--><path d="M1474.1511,1862.6577 C1542.4745,1866.0654 1593.0782,1880.7183 1593.0782,1906.5824 C1593.0782,1930.2315 1550.7892,1944.4755 1491.3597,1949.3825 " fill="none" id="Compensation-&gt;Compensation" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="1474.1511,1950.507,1505.6499,1962.0913,1491.1525,1949.3866,1503.8572,1934.8891,1474.1511,1950.507" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="337.3577" x="1613.5241" y="1898.2962">On failure, retry</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="112.4526" x="1645.8968" y="1950.4692">up to</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="27.2612" x="1771.98" y="1950.4692">n</text><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="119.2679" x="1812.8719" y="1950.4692">times</text><!--MD5=[a5fb969f75b12fd1586d6e4435061f5e]
link Compensation to MonitoredLog--><path d="M1214.0108,2018.2512 C1230.6061,2090.8342 1252.5173,2186.6234 1269.8282,2262.4096 " fill="none" id="Compensation-&gt;MonitoredLog" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="1273.6788,2279.2434,1280.1277,2246.3073,1269.8796,2262.6341,1253.5528,2252.386,1273.6788,2279.2434" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="436.1797" x="1250.609" y="2165.797">compensation failed</text><!--MD5=[9f8583fa48b46ff11bfa753b8cdadef0]
link CreditAccount to ActivityLog--><path d="M711.3478,1533.5465 C681.5308,1712.4142 621.8628,2070.3883 590.1034,2260.9443 " fill="none" id="CreditAccount-&gt;ActivityLog" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="587.1047,2278.8345,605.6313,2250.8498,589.9295,2262.032,578.7473,2246.3302,587.1047,2278.8345" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="170.3827" x="667.9002" y="1923.8536">success</text><!--MD5=[5e19c4f4d2ef4fba206dabd7200b3c15]
link Compensation to ActivityLog--><path d="M1048.5351,2018.2512 C951.7918,2092.6743 823.3233,2191.4622 723.7175,2268.1004 " fill="none" id="Compensation-&gt;ActivityLog" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="709.2691,2279.2434,741.886,2271.3369,722.7704,2268.8503,725.257,2249.7347,709.2691,2279.2434" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><text fill="#000000" font-family="sans-serif" font-size="44.2995" lengthAdjust="spacingAndGlyphs" textLength="170.3827" x="916.6589" y="2165.797">success</text><!--MD5=[76c4d7b27228bd66db4e1b33087461b5]
link ActivityLog to *end--><path d="M681.3945,2501.4224 C754.0797,2571.0408 844.0759,2657.2204 893.4869,2704.5186 " fill="none" id="ActivityLog-&gt;*end" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="906.2996,2716.7862,893.5588,2685.7371,893.9871,2705.0089,874.7152,2705.4372,906.2996,2716.7862" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><!--MD5=[7ac650ccae62e57a0ca7e67098a16ad0]
link MonitoredLog to *end--><path d="M1183.8871,2501.4224 C1109.8388,2571.0408 1018.1388,2657.2204 967.7737,2704.5186 " fill="none" id="MonitoredLog-&gt;*end" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><polygon fill="#383838" points="954.7224,2716.7862,986.3974,2705.6926,967.1297,2705.1087,967.7135,2685.841,954.7224,2716.7862" style="stroke: #383838; stroke-width: 3.4076539101497505;"/><!--MD5=[83458a826a62fddccf6a899b4dccba50]
@startuml

hide empty description
skinparam monochrome true
scale 2048 width

[*] - -> Init
Init: Transfer Service initialized with
Init: amount and two account references
Init: - - -
Init: Generate a transaction ID

Init - -> DebitAccount
DebitAccount: Debit the amount from the
DebitAccount: source account.

DebitAccount - -> DebitAccount: On failure, retry \nup to //n// times
DebitAccount - -> ActivityLog: failure

DebitAccount -down-> CreditAccount: successful charge
CreditAccount: Credit target account\nwith same amount
CreditAccount - -> CreditAccount: On failure, retry\nup to //n// times

CreditAccount - -> Compensation: failed //n// times
Compensation: Roll back the original\ncharge on source account
Compensation - -> Compensation: On failure, retry \nup to //n// times

Compensation - -> MonitoredLog: compensation failed
MonitoredLog: Error log for transactions that\nneed human intervention

ActivityLog: Event Log for transactions\nin the system

CreditAccount - -> ActivityLog: success
Compensation - -> ActivityLog: success
ActivityLog - -> [*]
MonitoredLog - -> [*]

@enduml

PlantUML version 1.2019.11(Sun Sep 22 12:02:15 CEST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 11.0.4+10-LTS
Operating System: Mac OS X
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>